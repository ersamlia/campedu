{% extends 'main/base.html' %}
{% load static %}
{% block title %}Dashboard Siswa{% endblock %}

{% block custom_css %}
<style>
    /* === GAYA UMUM === */
    body {
        font-family: 'Nunito', sans-serif;
        background-color: #f0f2f5; /* Background sedikit lebih gelap agar kartu pop-up */
        color: #444;
    }
    
    /* === HERO SECTION (SAPAAN) === */
    /* Desain: Gradient Biru-Ungu yang Fun */
    .hero-welcome {
        background: linear-gradient(120deg, #558776 100%); /* Blue Gradient */
        /* Atau opsi lain: linear-gradient(120deg, #e0c3fc 0%, #8ec5fc 100%); (Purple-Blue) */
        color: #fff;
        border-radius: 1.5rem;
        padding: 2.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 8px 20px rgba(102, 166, 255, 0.3);
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: relative;
        overflow: hidden;
    }
   
  
    .hero-text { z-index: 1; text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .hero-text h1 {
        font-weight: 800;
        font-size: 2rem;
        margin-bottom: 0.5rem;
    }
    .hero-text p {
        font-size: 1.1rem;
        margin-bottom: 0;
        font-weight: 600;
    }
    .hero-icon {
        font-size: 3.5rem;
        background: rgba(255, 255, 255, 0.25);
        padding: 15px;
        border-radius: 20px;
        backdrop-filter: blur(5px);
        z-index: 1;
    }

    /* === STAT CARDS (KARTU DATA) === */
    /* Desain: Warna-warni cerah */
    .stat-card {
        background: #ffffff;
        border-radius: 1.2rem;
        padding: 1.5rem;
        border: none;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        transition: transform 0.2s;
    }
    .stat-card:hover {
        transform: translateY(-5px);
    }
    .stat-content { flex: 1; }
    .stat-label {
        font-size: 0.85rem;
        color: #888;
        font-weight: 700;
        text-transform: uppercase;
        margin-bottom: 0.3rem;
    }
    .stat-value {
        font-size: 1.3rem;
        font-weight: 800;
        color: #2d3e50;
    }
    .stat-icon-box {
        width: 55px; height: 55px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Warna Spesifik Kartu */
    /* 1. Langkah (Kuning/Oranye - Semangat) */
    .card-step .stat-icon-box { background: linear-gradient(135deg, #ffd200 0%, #f7971e 100%); color: white; }
    /* 2. Progres (Biru - Tenang) */
    .card-progress .stat-icon-box { background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%); color: white; }
    /* 3. Skor (Pink/Merah - Prestasi) */
    .card-score .stat-icon-box { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); color: white; }
    /* Note: Gradient pink di atas agar teks putih terlihat jelas, bisa diganti solid color */
    .card-score .stat-icon-box { background: linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%); color: white; }


    /* === ALUR BELAJAR (LIST) === */
    .timeline-container {
        background: #ffffff;
        border-radius: 1.5rem;
        padding: 2rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.03);
        border: none;
    }
    .timeline-header {
        font-weight: 800;
        color: #4e73df; /* Biru primer */
        font-size: 1.3rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.8rem;
        border-bottom: 2px dashed #e3e6f0;
    }

    /* Item List Styling */
    .learning-item {
        display: flex;
        align-items: center;
        padding: 1.2rem;
        margin-bottom: 1rem;
        border-radius: 1rem;
        background-color: #fff;
        border: 2px solid #f0f2f5;
        transition: all 0.2s;
    }

    /* 1. Selesai (Hijau Mint Segar) */
    .item-done {
        background-color: #e8f5e9; /* Mint sangat muda */
        border-color: #c8e6c9;
        color: #2e7d32;
    }
    .item-done .icon-status {
        color: #4caf50;
        font-size: 1.4rem;
    }
    .item-done .badge-custom {
        background: #a5d6a7; color: #1b5e20;
    }

    /* 2. Aktif (Ungu/Biru - Fokus Utama) */
    .item-active {
        border: 2px solid #667eea; /* Ungu Biru */
        background-color: #fff;
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
        transform: scale(1.01);
    }
    .item-active .title {
        font-size: 1.15rem;
        font-weight: 800;
        color: #5a67d8;
    }
    .item-active .badge-status {
        font-size: 0.75rem;
        background-color: #ebf4ff;
        color: #5a67d8;
        padding: 4px 8px;
        border-radius: 6px;
        font-weight: 700;
        text-transform: uppercase;
        margin-bottom: 5px;
        display: inline-block;
    }

    /* 3. Terkunci (Abu-abu) */
    .item-locked {
        background-color: #f8f9fa;
        color: #adb5bd;
        border-color: #f1f3f5;
    }
    .item-locked .icon-status { color: #dfe6ed; font-size: 1.2rem; }

    /* Tombol Lanjut (Rounded & Gradient) */
    .btn-continue {
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 50px;
        padding: 0.6rem 1.8rem;
        font-weight: 700;
        font-size: 0.95rem;
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 4px 10px rgba(118, 75, 162, 0.3);
        transition: transform 0.2s;
    }
    .btn-continue:hover {
        color: #B0CE88;
        transform: scale(1.05);
        text-decoration: none;
    }
    .badge-custom {
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 700;
    }

</style>
{% endblock %}

{% block content %}

<!-- HERO SECTION -->
<div class="hero-welcome">
    <div class="hero-text">
        <h1>Halo, {{ user.first_name|default:user.username }}! üöÄ</h1>
        <p>Siap berpetualang di dunia biologi hari ini?</p>
    </div>
    <div class="hero-icon">
        <i class="fas fa-user-astronaut"></i>
    </div>
</div>

<!-- STAT CARDS -->
<div class="row mb-4">
    <div class="col-xl-4 col-md-6 mb-3">
        <div class="stat-card card-step">
            <div class="stat-content">
                <div class="stat-label">Langkah Saat Ini</div>
                <div class="stat-value">
                    {% if next_step %}
                        {{ next_step.nama }}
                    {% else %}
                        Selesai! üèÅ
                    {% endif %}
                </div>
            </div>
            <div class="stat-icon-box">
                <i class="fas fa-map-signs"></i>
            </div>
        </div>
    </div>

    <div class="col-xl-4 col-md-6 mb-3">
        <div class="stat-card card-progress">
            <div class="stat-content">
                <div class="stat-label">Total Progres</div>
                <div class="stat-value">{{ progress_percentage }}%</div>
            </div>
            <div class="stat-icon-box">
                <i class="fas fa-rocket"></i>
            </div>
        </div>
    </div>

    <div class="col-xl-4 col-md-6 mb-3">
        <div class="stat-card card-score">
            <div class="stat-content">
                <div class="stat-label">Skor Latihan</div>
                <div class="stat-value">{{ skor_terakhir }}</div>
            </div>
            <div class="stat-icon-box">
                <i class="fas fa-crown"></i>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="timeline-container">
            <div class="timeline-header">
                <i class="fas fa-list-ul mr-2"></i> Misi Belajar Kamu
            </div>

            {% for item in alur_belajar_data %}
                
                {% if item.status == 'selesai' %}
                <div class="learning-item item-done">
                    <div class="mr-3 icon-status">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="flex-grow-1">
                        <span style="font-weight: 700;">{{ item.nama }}</span>
                    </div>
                    <div>
                        <span class="badge-custom">Selesai</span>
                    </div>
                </div>

                {% elif item.status == 'aktif' %}
                <div class="learning-item item-active my-3">
                    <div class="mr-4 icon-status text-center">
                        <i class="fas fa-star fa-lg text-warning" style="color: #f6e05e;"></i>
                    </div>
                    <div class="flex-grow-1">
                        <span class="badge-status">Sedang Berlangsung</span>
                        <div class="title">{{ item.nama }}</div>
                    </div>
                    <div>
                        <a href="{{ item.url }}" class="btn-continue">
                            Mulai <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                </div>

                {% else %}
                <div class="learning-item item-locked">
                    <div class="mr-3 icon-status">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="flex-grow-1">
                        {{ item.nama }}
                    </div>
                </div>
                {% endif %}

            {% endfor %}

        </div>
    </div>
</div>

{% endblock %}

{% block custom_js %}
{% endblock %}