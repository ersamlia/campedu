{% extends 'main/base.html' %}
{% load static %}

{% block title %}Modul 2: Klasifikasi Makhluk Hidup{% endblock %}

{% block custom_css %}
<style>
@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap');
body { font-family: 'Nunito', sans-serif; background: #f0f8ff; }

/* === HEADER === */
.modul-header-card {
    background: white; padding: 1.2rem; border-radius: 1rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 2rem;
    border-left: 6px solid #4e73df; display: flex; justify-content: space-between; align-items: center;
}
.step-badge {
    background: #eef2ff; color: #4e73df; padding: 8px 16px; border-radius: 30px;
    font-weight: 800; letter-spacing: 0.5px; border: 1px solid #d1d3e2;
}

/* === LEARNING CARD === */
.learning-slide { display: none; opacity: 0; transition: opacity 0.5s ease-in-out; }
.learning-slide.active { display: block; opacity: 1; }

.learning-card {
    background: white; border-radius: 1.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    padding: 3rem; position: relative; overflow: hidden;
}

h3.title-highlight { color: #2e59d9; font-weight: 900; margin-bottom: 1rem; }
p.text-content { font-size: 1.1rem; color: #555; line-height: 1.8; }

/* === SLIDE 1: STIMULASI === */
.comparison-wrapper { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; }
.comparison-card {
    flex: 1; min-width: 250px; border: 2px solid #eaecf4; border-radius: 15px; 
    overflow: hidden; text-align: center; transition: 0.3s; cursor: pointer;
}
.comparison-card:hover { border-color: #4e73df; transform: translateY(-5px); }
.comparison-card img { width: 100%; height: 200px; object-fit: cover; }
.comparison-body { padding: 15px; }
.check-list { text-align: left; margin-top: 10px; font-size: 0.9rem; }
.check-item { margin-bottom: 5px; display: flex; align-items: center; }

/* === SLIDE 2: MIKROSKOP === */
.microscope-area {
    background: #1a1a1a; border-radius: 20px; padding: 20px; color: white;
    display: flex; flex-direction: column; align-items: center; position: relative;
}
.lens-circle {
    width: 300px; height: 300px; border: 5px solid #555; border-radius: 50%;
    overflow: hidden; background: black; box-shadow: 0 0 20px rgba(255,255,255,0.1);
    margin-bottom: 20px; position: relative;
}
.lens-circle video, .lens-circle img { width: 100%; height: 100%; object-fit: cover; }
.preparat-controls { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
.btn-preparat {
    background: #333; border: 1px solid #555; color: white; padding: 8px 15px;
    border-radius: 20px; transition: 0.3s; font-size: 0.9rem;
}
.btn-preparat:hover, .btn-preparat.active { background: #4e73df; border-color: #4e73df; }

/* === SLIDE 3: KUNCI DIKOTOM === */
.dikotom-container {
    max-width: 750px; margin: 0 auto; background: #f8f9fc; border-radius: 15px; 
    padding: 30px; border: 2px solid #e3e6f0; text-align: center;
}
.plant-display {
    display: inline-block; border: 4px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    border-radius: 15px; overflow: hidden; margin-bottom: 20px; width: 200px; height: 200px;
}
.plant-display img { width: 100%; height: 100%; object-fit: cover; }
.question-text { font-size: 1.25rem; font-weight: 800; color: #2e59d9; margin-bottom: 20px; }
.btn-choice {
    display: block; width: 100%; margin-bottom: 10px; padding: 12px;
    background: white; border: 2px solid #d1d3e2; border-radius: 10px;
    text-align: left; font-weight: 700; color: #555; transition: 0.2s; cursor: pointer;
    position: relative;
}
.btn-choice:hover { border-color: #1cc88a; color: #1cc88a; background: #f0fcf6; transform: translateX(5px); }
.breadcrumb-dikotom { font-size: 0.85rem; color: #888; margin-bottom: 15px; font-style: italic; }

/* === SLIDE 4: TAKSON (VISUAL STYLE) === */
.takson-pyramid {
    display: flex; flex-direction: column; align-items: center; gap: 8px;
}
.takson-level {
    width: 100%; text-align: center; padding: 12px; 
    color: white; font-weight: 800; background-color: #4e73df; 
    border-radius: 8px; cursor: pointer; transition: 0.3s;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1); letter-spacing: 1px;
    border: 1px solid #2e59d9;
    text-transform: uppercase; 
}
.takson-level:hover { transform: scale(1.05); background-color: #2e59d9; z-index: 10; }
.takson-level.active { background-color: #1cc88a; border-color: #17a673; transform: scale(1.05); box-shadow: 0 0 15px rgba(28, 200, 138, 0.4); }

/* Info Box Takson */
.takson-info-box {
    background: #fff; border-left: 6px solid #1cc88a; padding: 30px; 
    border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); height: 100%;
    display: flex; flex-direction: column; justify-content: flex-start;
    transition: all 0.3s ease;
}
.takson-gallery {
    display: flex; gap: 15px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap;
}
.takson-card {
    width: 140px; background: #fff; border-radius: 8px; overflow: hidden; 
    box-shadow: 0 3px 6px rgba(0,0,0,0.1); border: 1px solid #f0f0f0;
    display: flex; flex-direction: column;
}
.takson-card img { width: 100%; height: 100px; object-fit: cover; }
.takson-card-body { padding: 8px; text-align: center; flex-grow: 1; }
.takson-card-title { font-weight: 800; font-size: 0.8rem; color: #333; margin-bottom: 3px; }
.takson-card-reason { font-size: 0.7rem; color: #1cc88a; line-height: 1.2; margin-bottom: 5px; }
.takson-card-source { font-size: 0.6rem; color: #aaa; font-style: italic; border-top: 1px solid #eee; padding-top: 3px; }

.takson-latin { font-size: 1.6rem; font-weight: 900; color: #1cc88a; margin-bottom: 5px; text-align: center; }
.takson-indo { font-size: 1.1rem; color: #858796; font-weight: 700; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; text-align: center; border-bottom: 1px solid #eee; padding-bottom: 10px;}
.takson-desc { font-size: 1.1rem; line-height: 1.8; color: #444; text-align: justify; }

@media (max-width: 768px) {
    .lens-circle { width: 250px; height: 250px; }
}
</style>
{% endblock %}

{% block content %}

<div class="modul-header-card sticky-top" style="top: 15px; z-index: 99;">
    <div>
        <h5 class="font-weight-bold text-primary m-0"><i class="fas fa-sitemap mr-2"></i>Modul 2: Klasifikasi Makhluk Hidup</h5>
        <small class="text-muted">Observasi & Pengelompokan</small>
    </div>
    <div id="step-badge" class="step-badge">1. Ciri Kehidupan</div>
</div>

<div id="slide-1" class="learning-slide active">
    <div class="learning-card">
        <h3 class="title-highlight text-center">Robot vs Kucing: Mana yang Hidup?</h3>
        <p class="text-content text-center mb-4">
            Perhatikan Mobil-mobilan dan Kucing di bawah ini. Keduanya bisa bergerak. 
            Apakah keduanya Makhluk Hidup? <strong>Klik gambar</strong> untuk mengecek cirinya!
        </p>

        <div class="comparison-wrapper">
            <div class="comparison-card" onclick="checkCiri('mobil')">
                <img src="{% static 'img/mobil.png' %}" alt="Mobil">
                <div class="comparison-body">
                    <h5 class="font-weight-bold">Mobil-mobilan</h5>
                    <div id="list-mobil" style="display:none;" class="check-list">
                        <div class="check-item"><i class="fas fa-check text-success mr-2"></i> Bergerak? (Ya)</div>
                        <div class="check-item"><i class="fas fa-times text-danger mr-2"></i> Bernapas? (Tidak)</div>
                        <div class="check-item"><i class="fas fa-times text-danger mr-2"></i> Tumbuh Besar? (Tidak)</div>
                    </div>
                    <div id="res-mobil" class="alert alert-secondary mt-3 p-2" style="display:none;">
                        <strong>BENDA TAK HIDUP</strong>
                    </div>
                </div>
            </div>

            <div class="comparison-card" onclick="checkCiri('kucing')">
                <img src="{% static 'img/kucing.jpeg' %}" alt="Kucing">
                <div class="comparison-body">
                    <h5 class="font-weight-bold">Kucing</h5>
                    <div id="list-kucing" style="display:none;" class="check-list">
                        <div class="check-item"><i class="fas fa-check text-success mr-2"></i> Bergerak? (Ya)</div>
                        <div class="check-item"><i class="fas fa-check text-success mr-2"></i> Bernapas? (Ya)</div>
                        <div class="check-item"><i class="fas fa-check text-success mr-2"></i> Tumbuh Besar? (Ya)</div>
                    </div>
                    <div id="res-kucing" class="alert alert-success mt-3 p-2" style="display:none;">
                        <strong>MAKHLUK HIDUP</strong>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-4">
            <button id="btn-next-1" class="btn btn-primary btn-lg rounded-pill px-5 shadow disabled" onclick="nextSlide(2)">
                Lanjut: Pengamatan Mikroskopis <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </div>
</div>

<div id="slide-2" class="learning-slide">
    <div class="learning-card">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h3 class="title-highlight">Misteri Air Kolam</h3>
                <p class="text-content">
                    Kita sudah tahu Kucing itu hidup. Tapi bagaimana dengan setetes air kolam yang terlihat bening ini? 
                    Gunakan mikroskop untuk melihat kehidupan yang tak kasat mata!
                </p>
                
                <div class="mt-4">
                    <h6 class="font-weight-bold mb-3">Pilih Sampel Preparat:</h6>
                    <div class="preparat-controls justify-content-start">
                        <button class="btn btn-preparat" onclick="setMicroscope('air', this)">1. Air Kolam</button>
                        <button class="btn btn-preparat" onclick="setMicroscope('darah', this)">2. Sel Darah</button>
                        <button class="btn btn-preparat" onclick="setMicroscope('daun', this)">3. Sel Daun</button>
                    </div>
                    
                    <div id="micro-result" class="mt-3 p-3 rounded bg-light border" style="display:none;">
                        <h6 class="font-weight-bold text-primary" id="micro-title"></h6>
                        <p class="small mb-0 text-dark" id="micro-desc"></p>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6 mt-4 mt-lg-0">
                <div class="microscope-area">
                    <div class="lens-circle">
                        <video id="micro-view" poster="{% static 'img/lensa_kosong.png' %}" loop muted playsinline></video>
                    </div>
                    <small class="text-white-50">Perbesaran 400x</small>
                </div>
            </div>
        </div>

        <div class="text-right mt-4">
            <button id="btn-next-2" class="btn btn-primary btn-lg rounded-pill px-5 shadow disabled" onclick="nextSlide(3)">
                Lanjut: Kunci Dikotom <i class="fas fa-sitemap ml-2"></i>
            </button>
        </div>
    </div>
</div>

<div id="slide-3" class="learning-slide">
    <div class="learning-card">
        <div class="text-center mb-4">
            <h3 class="title-highlight">Praktikum: Kunci Determinasi</h3>
            <p class="text-content">
                Ayo identifikasi <strong>5 Tumbuhan</strong> berikut menggunakan Kunci Dikotom. 
                Pilih ciri yang sesuai dengan gambar untuk mengetahui nama kelompoknya!
            </p>
            
            <div class="d-flex justify-content-center align-items-center mb-3">
                <span class="badge badge-primary px-3 py-2 mr-3" id="plant-counter">Tanaman 1 / 5</span>
            </div>

            <div class="plant-display">
                <img id="current-plant-img" src="" alt="Tanaman Misterius">
            </div>
            <h5 class="font-weight-bold text-primary mb-3" id="current-plant-name">...</h5>
        </div>

        <div class="dikotom-container shadow-sm">
            <div class="breadcrumb-dikotom" id="dikotom-path">Mulai</div>
            <div id="question-area">
                </div>
        </div>

        <div class="text-center mt-4">
            <button id="btn-reset-plant" class="btn btn-outline-secondary btn-sm" onclick="resetDikotom()" style="display:none;"><i class="fas fa-redo mr-1"></i> Ulangi Tanaman Ini</button>
            <button id="btn-next-plant" class="btn btn-success rounded-pill ml-2" onclick="nextPlant()" style="display:none;">
                Tanaman Berikutnya <i class="fas fa-chevron-right ml-2"></i>
            </button>
            <button id="btn-finish-modul" class="btn btn-primary rounded-pill ml-2 disabled" style="display:none;" onclick="nextSlide(4)">
                Lihat Kesimpulan (Takson) <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </div>
</div>

<div id="slide-4" class="learning-slide">
    <div class="learning-card">
        <h3 class="title-highlight text-center">Hierarki Taksonomi</h3>
        <p class="text-content text-center mb-4">
            Ilmuwan mengurutkan makhluk hidup dari kelompok besar ke kecil.
            <strong>Klik tingkat piramida</strong> untuk melihat contoh <strong>Hewan (Kucing)</strong> dan <strong>Tumbuhan (Jagung)</strong> di setiap tingkatan.
        </p>

        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="takson-pyramid">
                    <div class="takson-level" style="width: 100%;" onclick="showTaksonInfo(this, 'kingdom')">KINGDOM</div>
                    <div class="takson-level" style="width: 90%;" onclick="showTaksonInfo(this, 'filum')">PHYLUM / DIVISION</div>
                    <div class="takson-level" style="width: 80%;" onclick="showTaksonInfo(this, 'kelas')">CLASS</div>
                    <div class="takson-level" style="width: 70%;" onclick="showTaksonInfo(this, 'ordo')">ORDER</div>
                    <div class="takson-level" style="width: 60%;" onclick="showTaksonInfo(this, 'familia')">FAMILY</div>
                    <div class="takson-level" style="width: 50%;" onclick="showTaksonInfo(this, 'genus')">GENUS</div>
                    <div class="takson-level" style="width: 40%;" onclick="showTaksonInfo(this, 'spesies')">SPECIES</div>
                </div>
            </div>

            <div class="col-md-8">
                <div id="takson-detail" class="takson-info-box text-center">
                    <i class="fas fa-arrow-left fa-3x text-muted mb-3"></i>
                    <h5 class="text-muted">Klik tingkatan di samping untuk melihat detailnya.</h5>
                </div>
            </div>
        </div>

        <div class="text-center mt-5">
            <a href="{% url 'selesai_step' 'modul_2' %}" class="btn btn-success btn-lg rounded-pill px-5 shadow">
                Selesai Modul 2 <i class="fas fa-check-circle ml-2"></i>
            </a>
        </div>
    </div>
</div>

{% endblock %}

{% block custom_js %}
<script>
// === 1. NAVIGASI GLOBAL ===
const stepNames = ["1. Ciri Kehidupan", "2. Pengamatan Mikroskopis", "3. Kunci Dikotom", "4. Tingkatan Takson"];

function nextSlide(n) {
    document.querySelectorAll('.learning-slide').forEach(el => {
        el.classList.remove('active');
        el.style.opacity = 0;
    });
    const target = document.getElementById('slide-' + n);
    target.classList.add('active');
    setTimeout(() => target.style.opacity = 1, 50);
    document.querySelector('.modul-header-card').scrollIntoView({behavior: 'smooth'});
    if(stepNames[n-1]) document.getElementById('step-badge').innerText = stepNames[n-1];

    // Init Dikotom if entering slide 3
    if(n === 3) {
        loadPlant(0); 
    }
}

// === 2. SLIDE 1 (STIMULASI) ===
let checked1 = false;
let checked2 = false;
function checkCiri(type) {
    if(type === 'mobil') {
        document.getElementById('list-mobil').style.display = 'block';
        document.getElementById('res-mobil').style.display = 'block';
        checked1 = true;
    } else {
        document.getElementById('list-kucing').style.display = 'block';
        document.getElementById('res-kucing').style.display = 'block';
        checked2 = true;
    }
    if(checked1 && checked2) document.getElementById('btn-next-1').classList.remove('disabled');
}

// === 3. SLIDE 2 (MIKROSKOP) ===
const slidesMicro = {
    'air': { video: "{% static 'video/airkolam.mp4' %}", title: "Kingdom Protista", desc: "Ditemukan Paramecium! Organisme bersel satu yang bergerak." },
    'darah': { video: "{% static 'video/seldarah.mp4' %}", title: "Sel Darah Merah", desc: "Sel penyusun jaringan hewan. Tidak memiliki dinding sel." },
    'daun': { video: "{% static 'video/seldaun.mp4' %}", title: "Sel Tumbuhan", desc: "Tampak kloroplas hijau dan dinding sel yang kaku." }
};
function setMicroscope(type, btn) {
    document.querySelectorAll('.btn-preparat').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const data = slidesMicro[type];
    const video = document.getElementById('micro-view');
    video.src = data.video;
    video.load();
    video.play().catch(e => console.log("Auto-play prevented"));
    document.getElementById('micro-title').innerText = data.title;
    document.getElementById('micro-desc').innerText = data.desc;
    document.getElementById('micro-result').style.display = 'block';
    document.getElementById('btn-next-2').classList.remove('disabled');
}

// === 4. SLIDE 3 (KUNCI DIKOTOM) ===
const plantsQueue = [
    { name: "Tanaman A (Suplir)", img: "{% static 'img/suplir.jpeg' %}", correctResult: "Paku (Pteridophyta)" },
    { name: "Tanaman B (Lumut)", img: "{% static 'img/lumut.jpeg' %}", correctResult: "Lumut (Bryophyta)" },
    { name: "Tanaman C (Melinjo)", img: "{% static 'img/melinjo.jpeg' %}", correctResult: "Gymnospermae (Melinjo)" },
    { name: "Tanaman D (Jagung)", img: "{% static 'img/jagung3.jpg' %}", correctResult: "Monokotil (Jagung)" },
    { name: "Tanaman E (Kacang)", img: "{% static 'img/kacang-tanah.jpg' %}", correctResult: "Dikotil (Kacang/Mangga)" }
];
let currentPlantIndex = 0;
const dikotomQuestions = {
    '1': { q: "1. Apakah tumbuhan ini memiliki spora?", a: {text: "1a. Berspora", next: '2'}, b: {text: "1b. Tidak Berspora", next: '3'} },
    '2': { q: "2. Apakah batangnya terlihat jelas?", a: {text: "2a. Batang Jelas", res: "Paku (Pteridophyta)"}, b: {text: "2b. Batang Tidak Jelas", res: "Lumut (Bryophyta)"} },
    '3': { q: "3. Bagaimana keadaan bijinya?", a: {text: "3a. Biji Tertutup", next: '4'}, b: {text: "3b. Biji Terbuka", res: "Gymnospermae (Melinjo)"} },
    '4': { q: "4. Berapa keping bijinya?", a: {text: "4a. Berkeping Dua", res: "Dikotil (Kacang/Mangga)"}, b: {text: "4b. Berkeping Satu", res: "Monokotil (Jagung)"} }
};

function loadPlant(index) {
    const plant = plantsQueue[index];
    document.getElementById('current-plant-img').src = plant.img;
    document.getElementById('current-plant-name').innerText = plant.name;
    document.getElementById('plant-counter').innerText = `Tanaman ${index + 1} / ${plantsQueue.length}`;
    document.getElementById('btn-next-plant').style.display = 'none';
    document.getElementById('btn-reset-plant').style.display = 'block';
    renderDikotom('1');
    document.getElementById('dikotom-path').innerText = "Mulai";
}

function renderDikotom(qId) {
    const data = dikotomQuestions[qId];
    const area = document.getElementById('question-area');
    let html = `<div class="question-text">${data.q}</div>`;
    if(data.a.res) {
        html += `<button class="btn-choice" onclick="checkAnswer('${data.a.res}', true)">${data.a.text}</button>`;
    } else {
        html += `<button class="btn-choice" onclick="nextStep('${data.a.next}', '${data.a.text}')">${data.a.text}</button>`;
    }
    if(data.b.res) {
        html += `<button class="btn-choice" onclick="checkAnswer('${data.b.res}', false)">${data.b.text}</button>`;
    } else {
        html += `<button class="btn-choice" onclick="nextStep('${data.b.next}', '${data.b.text}')">${data.b.text}</button>`;
    }
    area.innerHTML = html;
}

function nextStep(nextId, text) {
    document.getElementById('dikotom-path').innerHTML += " &rarr; " + text;
    renderDikotom(nextId);
}

function checkAnswer(result) {
    const target = plantsQueue[currentPlantIndex].correctResult;
    const area = document.getElementById('question-area');
    if (result === target) {
        area.innerHTML = `<div class="alert alert-success p-4 text-center"><h1 class="display-4"><i class="fas fa-check-circle text-success"></i></h1><h5 class="font-weight-bold">IDENTIFIKASI TEPAT!</h5><p>Tanaman ini benar adalah <strong>${result}</strong>.</p></div>`;
        if (currentPlantIndex < plantsQueue.length - 1) {
            document.getElementById('btn-next-plant').style.display = 'inline-block';
            document.getElementById('btn-reset-plant').style.display = 'none';
        } else {
            document.getElementById('btn-finish-modul').style.display = 'inline-block';
            document.getElementById('btn-finish-modul').classList.remove('disabled');
            document.getElementById('btn-reset-plant').style.display = 'none';
        }
    } else {
        area.innerHTML = `<div class="alert alert-warning p-4 text-center"><h5 class="font-weight-bold">Kurang Tepat</h5><p>Kamu memilih: <strong>${result}</strong>.</p><button class="btn btn-outline-primary mt-2" onclick="resetDikotom()">Ulangi Identifikasi</button></div>`;
    }
}

function nextPlant() {
    currentPlantIndex++;
    loadPlant(currentPlantIndex);
}

function resetDikotom() {
    document.getElementById('dikotom-path').innerText = "Mulai";
    renderDikotom('1');
}

// === 5. SLIDE 4 LOGIC (TAKSONOMI FINAL DENGAN TUMBUHAN) ===
const taksonEnriched = {
    'kingdom': {
        latin: 'REGNUM (Dunia)',
        indo: 'Kerajaan',
        desc: `Tingkatan tertinggi. Anggotanya sangat banyak dan beragam. Ciri persamaannya masih sangat umum.<br><br>
               <strong>Contoh Hewan:</strong> Kingdom Animalia (Semua Hewan, termasuk Kucing dan Ikan).<br>
               <strong>Contoh Tumbuhan:</strong> Kingdom Plantae (Semua Tumbuhan, termasuk Jagung).`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Kucing', reason: 'Hewan', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Jagung', reason: 'Tumbuhan', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/ikan2.jpeg' %}", label: 'Ikan', reason: 'Hewan', source: 'Dok. Kemdikbud'}
        ]
    },
    'filum': {
        latin: 'PHYLUM (Hewan) / DIVISIO (Tumbuhan)',
        indo: 'Filum / Divisi',
        desc: `<strong>Hewan:</strong> Filum Chordata (Bertulang Belakang). Kucing dan Ikan masuk, tapi Siput (hewan lunak) tidak.<br>
               <strong>Tumbuhan:</strong> Divisi Spermatophyta (Tumbuhan Berbiji). Jagung masuk, tapi Lumut (berspora) tidak.`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Kucing (Chordata)', reason: 'Tulang belakang', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Jagung (Spermatophyta)', reason: 'Berbiji', source: 'Dok. Kemdikbud'}
        ]
    },
    'kelas': {
        latin: 'CLASSIS',
        indo: 'Kelas',
        desc: `<strong>Hewan:</strong> Kelas Mammalia (Menyusui). Ikan (Pisces) tidak masuk.<br>
               <strong>Tumbuhan:</strong> Kelas Monokotil (Berkeping Satu). Mangga (Dikotil) tidak masuk.`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Kucing (Mammalia)', reason: 'Menyusui', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Jagung (Monokotil)', reason: 'Keping satu', source: 'Dok. Kemdikbud'}
        ]
    },
    'ordo': {
        latin: 'ORDO',
        indo: 'Bangsa',
        desc: `<strong>Hewan:</strong> Ordo Carnivora (Pemakan Daging). Sapi (Herbivora) tidak masuk.<br>
               <strong>Tumbuhan:</strong> Ordo Poales (Bangsa Rumput-rumputan). Kelapa tidak masuk.`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Kucing (Carnivora)', reason: 'Makan daging', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Jagung (Poales)', reason: 'Rumputan', source: 'Dok. Kemdikbud'}
        ]
    },
    'familia': {
        latin: 'FAMILIA',
        indo: 'Suku',
        desc: `<strong>Hewan:</strong> Familia Felidae (Keluarga Kucing). Anjing tidak masuk.<br>
               <strong>Tumbuhan:</strong> Familia Poaceae (Suku Rumput). Tebu masih saudara dekat, tapi padi agak jauh.`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Kucing (Felidae)', reason: 'Kucing-kucingan', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Jagung (Poaceae)', reason: 'Suku Rumput', source: 'Dok. Kemdikbud'}
        ]
    },
    'genus': {
        latin: 'GENUS',
        indo: 'Marga',
        desc: `<strong>Hewan:</strong> Genus <em>Felis</em> (Kucing Kecil). Harimau (<em>Panthera</em>) tidak masuk.<br>
               <strong>Tumbuhan:</strong> Genus <em>Zea</em>. Tebu (<em>Saccharum</em>) tidak masuk.`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Kucing (Felis)', reason: 'Kucing kecil', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Jagung (Zea)', reason: 'Marga Zea', source: 'Dok. Kemdikbud'}
        ]
    },
    'spesies': {
        latin: 'SPECIES',
        indo: 'Jenis',
        desc: `Tingkatan paling khusus. Hanya satu jenis makhluk hidup.<br><br>
               <strong>Hewan:</strong> <em>Felis catus</em> (Kucing Rumah).<br>
               <strong>Tumbuhan:</strong> <em>Zea mays</em> (Jagung Manis).`,
        images: [
            {src: "{% static 'img/kucing.jpeg' %}", label: 'Felis catus', reason: 'Spesies tunggal', source: 'Dok. Kemdikbud'},
            {src: "{% static 'img/jagung3.jpg' %}", label: 'Zea mays', reason: 'Spesies tunggal', source: 'Dok. Kemdikbud'}
        ]
    }
};

function showTaksonInfo(el, key) {
    document.querySelectorAll('.takson-level').forEach(d => {
        d.classList.remove('active');
    });
    el.classList.add('active');

    const data = taksonEnriched[key];
    const box = document.getElementById('takson-detail');
    
    let galleryHTML = '<div class="takson-gallery">';
    data.images.forEach(img => {
        galleryHTML += `
            <div class="takson-card">
                <img src="${img.src}">
                <div class="takson-card-body">
                    <div class="takson-card-title">${img.label}</div>
                    <div class="takson-card-reason">${img.reason}</div>
                    <div class="takson-card-source">Sumber: ${img.source}</div>
                </div>
            </div>`;
    });
    galleryHTML += '</div>';

    box.innerHTML = `
        <div class="animated fadeIn">
            <div class="takson-header">
                <div class="takson-latin">${data.latin}</div>
                <div class="takson-indo">${data.indo}</div>
            </div>
            ${galleryHTML}
            <div class="takson-desc">${data.desc}</div>
        </div>
    `;
}
</script>
{% endblock %}